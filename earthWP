#!/bin/bash

dir=/home/josh/Pictures/Wallpapers

  # | egrep "500px|imgur|flickr|squarespace" \

sites=("http://www.reddit.com/r/earthporn/top/?sort=top&t=week" \
		"http://www.reddit.com/r/spaceporn/top/?sort=top&t=week"
)

randomSite=${sites[$RANDOM % ${#sites[@]} ]}

url=$(curl -s $randomSite\
  | tr '"' '\n' \
  | egrep '^http://.*\.(jpg)|(png)' \
  | egrep -v 'reddit' \
  | shuf -n1 \
  | sed 's/\?.*$//g' \
  | uniq)

ext="${url##*.}"
sha=$(cksum <<< "$url" | tr -d ' ')
wget -nc "$url" -O "$dir/$sha.$ext"

feh --bg-fill "$dir/$sha.$ext"
